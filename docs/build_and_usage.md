# Инструкция по сборке и использованию

## Требования

### Системные требования
- Операционная система: Linux, macOS или Windows
- Компилятор C++17 или новее (GCC 7+, Clang 5+, MSVC 2017+)
- CMake версии 3.10 или новее

### Рекомендуемые версии
- GCC 9+ или Clang 9+
- CMake 3.16+
- Не менее 4 ГБ оперативной памяти
- 100 МБ свободного места на диске

## Сборка проекта

### 1. Клонирование и подготовка
```bash
# Перейти в директорию проекта
cd digital_processing

# Создать директорию для сборки
mkdir build
cd build
```

### 2. Конфигурация и сборка
```bash
# Конфигурация проекта
cmake ..

# Сборка (параллельная сборка на 4 ядрах)
make -j4
```

### 3. Альтернативный способ с Release сборкой
```bash
cmake -DCMAKE_BUILD_TYPE=Release ..
make -j4
```

## Исполняемые файлы

После успешной сборки будут созданы следующие программы:

### `echo_filter_test`
Основная программа для демонстрации и тестирования алгоритмов.

```bash
./echo_filter_test
```

**Режимы работы:**
1. **Демонстрация алгоритмов** - быстрый обзор возможностей каждого алгоритма
2. **Полное тестирование** - комплексное сравнение всех алгоритмов на большом наборе данных
3. **Тестирование масштабируемости** - анализ производительности при различных размерах сигналов

### `generate_test_data`
Утилита для генерации тестовых данных.

```bash
# Генерация с параметрами по умолчанию
./generate_test_data

# Генерация 100 сигналов длиной 2000 отсчетов
./generate_test_data -n 100 -l 2000 -o my_test_data

# Справка по параметрам
./generate_test_data --help
```

**Параметры:**
- `-n, --num-signals N` - количество сигналов (по умолчанию: 10)
- `-l, --length L` - длина каждого сигнала (по умолчанию: 1000)
- `-s, --seed S` - начальное значение генератора (по умолчанию: 42)
- `-o, --output DIR` - выходная директория (по умолчанию: data)

## Структура выходных данных

### Результаты тестирования
После выполнения полного тестирования создаются следующие файлы:

```
results/
├── benchmark_results.csv    # Сводная таблица результатов
└── detailed_report.txt      # Подробный отчет
```

### Тестовые данные
```
data/
├── clean/                   # Чистые эхо сигналы
│   ├── signal_0.csv
│   ├── signal_1.csv
│   └── ...
└── noisy/                   # Сигналы с добавленными помехами
    ├── signal_0.csv
    ├── signal_1.csv
    └── ...
```

## Формат CSV файлов

Все сигналы сохраняются в CSV формате с заголовком:
```csv
Index,Value
0,0.0245
1,0.0189
2,0.0156
...
```

## Пример использования

### 1. Полный цикл тестирования

```bash
# Сборка проекта
mkdir build && cd build
cmake .. && make -j4

# Генерация тестовых данных
./generate_test_data -n 50 -l 1500 -o test_signals

# Запуск основного тестирования
./echo_filter_test
# Выбрать пункт 2 (Полное тестирование)
```

### 2. Быстрая демонстрация

```bash
# Запуск демонстрации
./echo_filter_test
# Выбрать пункт 1 (Демонстрация алгоритмов)
```

## Параметры алгоритмов

### Медианный фильтр
- **Размер окна**: 3, 5, 7, 9 (рекомендуется 5-7 для большинства случаев)
- **Применение**: эффективен против одиночных импульсов

### Фильтр Винера
- **Порядок фильтра**: 6-12 (больше для сложных сигналов)
- **Шаг адаптации (μ)**: 0.001-0.01 (меньше для стабильности)
- **Коэффициент забывания (λ)**: 0.99-0.999 (больше для медленных изменений)

### Морфологические фильтры
- **Размер структурирующего элемента**: 3-7
- **Операция**:
  - Opening - для подавления положительных импульсов
  - Closing - для подавления отрицательных импульсов

### Обнаружение выбросов
- **Метод обнаружения**:
  - MAD_BASED - универсальный, робастный
  - STATISTICAL - для гауссовского шума
  - ADAPTIVE_THRESHOLD - для переменных условий
- **Порог**: 2.0-4.0 (больше для снижения ложных срабатываний)
- **Размер окна**: 7-15 (должен быть нечетным)

## Анализ результатов

### Ключевые метрики

1. **SNR (Signal-to-Noise Ratio)** - отношение сигнал/шум в дБ
   - Больше → лучше качество восстановления
   - Типичные значения: 10-30 дБ

2. **MSE (Mean Squared Error)** - среднеквадратичная ошибка
   - Меньше → лучше точность
   - Зависит от амплитуды сигналов

3. **Корреляция** - коэффициент корреляции с исходным сигналом
   - 0.0-1.0, больше → лучше сохранение формы
   - Желательно > 0.8

4. **Время выполнения** - в микросекундах
   - Важно для real-time приложений

### Интерпретация результатов

**Лучший алгоритм по качеству:** максимальный SNR и корреляция, минимальный MSE

**Лучший алгоритм по скорости:** минимальное время выполнения

**Универсальный выбор:** компромисс между качеством и скоростью

## Решение проблем

### Ошибки компиляции

1. **Отсутствует C++17 поддержка**
   ```bash
   # Для старых версий GCC добавьте флаг
   cmake -DCMAKE_CXX_FLAGS="-std=c++17" ..
   ```

2. **Проблемы с CMake**
   ```bash
   # Очистите кэш CMake
   rm -rf CMakeCache.txt CMakeFiles/
   cmake ..
   ```

### Ошибки выполнения

1. **Нехватка памяти**
   - Уменьшите количество тестовых сигналов
   - Уменьшите длину сигналов

2. **Файлы не создаются**
   - Проверьте права доступа к директории
   - Убедитесь, что директория существует

### Производительность

1. **Медленное выполнение**
   - Используйте Release сборку: `cmake -DCMAKE_BUILD_TYPE=Release ..`
   - Уменьшите количество тестовых данных
   - Используйте параллельную сборку: `make -j$(nproc)`

## Расширение функциональности

### Добавление нового алгоритма

1. Создайте классы заголовка и реализации, наследующиеся от `SignalProcessor`
2. Реализуйте методы `process()` и `getName()`
3. Добавьте новые файлы в `CMakeLists.txt`
4. Включите алгоритм в тестирование в `main.cpp`

### Новые типы тестовых сигналов

1. Расширьте enum `EchoType` в `signal_generator.h`
2. Добавьте соответствующий метод генерации
3. Обновите switch-case в `generatePulse()`

Для получения дополнительной помощи обратитесь к исходному коду или создайте issue в репозитории проекта.